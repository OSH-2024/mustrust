# 研究背景

## 嵌入式系统的重要性：

嵌入式系统在现代技术中的应用广泛，涵盖物联网(IoT)、汽车电子、家用电器、工业控制系统等领域。这些系统通常被设计用于执行特定的功能，如数据采集、实时控制、通信等，因此对于可靠性、安全性和性能有着严格的要求。在物联网中，嵌入式系统负责连接和传输数据，要求系统稳定、安全，能够长时间运行而不失效。在汽车电子领域，嵌入式系统承担着车辆控制、安全监测等任务，对系统的实时性和可靠性要求尤为突出。

## 实时操作系统（RTOS）的作用：

RTOS在嵌入式系统中扮演着关键角色，它为系统提供任务调度、中断管理、资源控制等功能，确保系统能够按时响应外部事件并保持稳定运行。特别是在需要处理多任务、对响应时间有严格要求的场景下，RTOS的作用更加凸显，它可以帮助系统有效管理各个任务的执行顺序和优先级，提高系统的实时性和可靠性。

## FreeRTOS的普及与限制：

FreeRTOS作为一个流行的开源RTOS，拥有广泛的用户群体和社区支持。它具有轻量级、可移植性强等特点，在许多嵌入式系统中得到了广泛应用。然而，FreeRTOS也存在一些局限性，其中之一是在内存管理方面的不足。传统的FreeRTOS采用静态内存分配方式，难以适应动态内存需求，而且缺乏内存保护机制，容易出现内存越界等安全问题，限制了其在一些对安全性要求较高的场景下的应用。

## 内存管理单元（MMU）的必要性：

MMU在提供内存保护、支持多任务和提高系统安全性方面起着关键作用。通过MMU，系统可以实现内存隔离，防止任务之间相互干扰或者非法访问其他任务的内存空间，从而提高系统的稳定性和安全性。尤其对于需要运行多个任务且任务之间信任关系复杂的嵌入式系统来说，MMU的存在至关重要。

## 系统级编程语言的选择：

为了解决FreeRTOS存在的内存管理等问题，选择现代系统级编程语言进行重写变得至关重要。Rust作为一种内存安全、并发支持、生命周期管理等特性鲜明的编程语言，非常适合用于嵌入式系统的开发。其严格的借用检查机制可以有效地预防内存安全问题，而且具备并发编程的支持，可以简化多任务系统的开发和管理。

## Rust在嵌入式系统中的应用前景：

Rust在嵌入式系统领域的应用呈现出增长趋势和潜力。随着对系统安全性和稳定性要求的提高，以及Rust生态系统中针对嵌入式开发的库和工具的不断完善，越来越多的开发者开始将Rust应用于嵌入式系统的开发中。例如，Tock操作系统就是一个基于Rust开发的嵌入式操作系统，它在安全性和性能方面具有显著优势，吸引了众多开发者的关注和参与。

## 研究的动机与目标：

基于以上考虑，本次研究旨在利用Rust编程语言重写FreeRTOS，并添加对MMU的支持，以解决传统FreeRTOS存在的内存管理和安全性等问题。通过这样的工作，预期可以提高系统的稳定性、安全性和性能，为嵌入式系统开发提供更可靠的解决方案。

## 现有工作的回顾：

目前已经有一些类似的工作正在进行或者已经完成，但大多集中在基于C语言的RTOS或者使用Rust开发新的RTOS上，并没有针对在现有流行RTOS中添加MMU支持的工作。

首先，有一些工作正在使用Rust开发嵌入式实时操作系统（RTOS）。例如，Drone RTOS¹就是用Rust编写的嵌入式RTOS。它的设计原则包括能效、硬实时、具有严格优先级的抢占式多任务、高度并发、消息传递并发等¹。Drone RTOS的设计目标是在不影响嵌入式编程性能的情况下引入现代开发方法¹。

然后，有一篇文章对Embassy/Rust与FreeRTOS/C在嵌入式环境下的性能和易用度进行了比较²。这篇文章中，作者在STM32F446微控制器上使用Embassy/Rust与FreeRTOS/C运行相同的应用程序，并根据中断延迟、程序大小、内存使用情况和编程难易程度等差异来评价它们²。

尽管目前尚未发现用Rust重写FreeRTOS的完整项目，但已有一些初步尝试和相关研究正在进行中。这些工作为我们提供了宝贵的前期经验和技术基础，表明了这一研究方向的可行性和潜在价值。对于这些已有工作，需要进一步分析其成果和不足，以借鉴其经验并避免重复劳动。同时，这些工作也为本次研究提供了一定的启示和影响，有助于指导后续的研究方向和工作重点。

(1) 基于stm32f4单片机的rust嵌入式编程之（七）开启Drone RTOS之旅① - 知乎. https://zhuanlan.zhihu.com/p/353046644.

(2) 嵌入式异步Rust与RTOS的最终决战！【翻译】 - 知乎专栏. https://zhuanlan.zhihu.com/p/604927675.